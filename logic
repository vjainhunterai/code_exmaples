processed_files = set()

if isinstance(listDir, list):
    for directory in listDir:
        for file in fetchUnprocessedFile:
            if file not in processed_files:
                try:
                    downloadAndProcessFile(s3Client, bucketName, file, directory, localDirectory)
                    processed_files.add(file)
                except Exception as e:
                    print(f"An error occurred: {e}")
