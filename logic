processed_files = set()

if isinstance(listDir, list):
    for directory in listDir:
        for file in fetchUnprocessedFile:
            file_identifier = file["filename"]  # Adjust this key based on your actual file structure

            if file_identifier not in processed_files:
                try:
                    downloadAndProcessFile(s3Client, bucketName, file, directory, localDirectory)
                    processed_files.add(file_identifier)
                except Exception as e:
                    print(f"An error occurred: {e}")
